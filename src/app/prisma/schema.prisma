generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model budget_membership {
  budget_id BigInt
  user_id   BigInt
  budgets   budgets @relation(fields: [budget_id], references: [budget_id], onDelete: NoAction, onUpdate: NoAction)
  users     users   @relation(fields: [user_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction)

  @@id([budget_id, user_id])
}

model budgets {
  budget_id         BigInt              @id @unique @default(autoincrement())
  created_at        DateTime            @default(now()) @db.Timestamptz(6)
  owner_id          BigInt
  name              String
  budget_membership budget_membership[]
  users             users               @relation(fields: [owner_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction)
  categories        categories[]
}

model categories {
  category_id   BigInt         @id @unique @default(autoincrement())
  name          String         @default("")
  max_spend     Int
  current_spend Int?
  budget_id     BigInt
  budgets       budgets        @relation(fields: [budget_id], references: [budget_id], onDelete: NoAction, onUpdate: NoAction)
  transactions  transactions[]
}

model transactions {
  transaction_id BigInt     @id @unique @default(autoincrement())
  date           String?
  amount         Int
  name           String
  category_id    BigInt
  categories     categories @relation(fields: [category_id], references: [category_id], onDelete: NoAction, onUpdate: NoAction)
}

model users {
  user_id           BigInt              @id @default(autoincrement())
  username          String              @unique
  password          String
  budget_membership budget_membership[]
  budgets           budgets[]
}
